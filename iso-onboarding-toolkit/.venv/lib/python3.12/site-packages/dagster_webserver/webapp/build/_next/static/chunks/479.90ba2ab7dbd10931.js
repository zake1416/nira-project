(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[479],{40860:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MergedAutomationRoot:()=>eB,default:()=>eV});var s=n(99649),r=n(93096),o=n(6029),i=n(34419),a=n(62978),l=n(12547),c=n(67221),d=n(97962),u=n(36660),p=n(71802),m=n(27589),h=n(55729),x=n(82343),g=n(98689),j=n(9448),f=n(31904),v=n(74016),S=n(98784),y=n(8131);let w={step:"initial",completion:{completed:0,errors:{}}},k=(e,t)=>{switch(t.type){case"reset":return w;case"start":return(0,r._)((0,s._)({},e),{step:"updating"});case"update-success":{let{completion:t}=e;return{step:"updating",completion:(0,r._)((0,s._)({},t),{completed:t.completed+1})}}case"update-error":{let{completion:n}=e;return{step:"updating",completion:(0,r._)((0,s._)({},n),{completed:n.completed+1,errors:(0,r._)((0,s._)({},n.errors),{[t.name]:t.error})})}}case"complete":return(0,r._)((0,s._)({},e),{step:"completed"})}};var I=n(24357),T=n(91680),A=n(65192);let _=e=>{let{openWithIntent:t,onClose:n,automations:a}=e,l=a.length,[c,p]=(0,h.useReducer)(k,w);(0,h.useEffect)(()=>{"not-open"===t&&p({type:"reset"})},[t,p]);let[m]=(0,S.n_)(A.kX),[x]=(0,S.n_)(A.qz),[g]=(0,S.n_)(T.DB),[_]=(0,S.n_)(T.Ds),b=async e=>{let{repoAddress:t,name:n,type:o}=e,i={repositoryLocationName:t.location,repositoryName:t.name};switch(o){case"sensor":{let{data:e}=await m({variables:{sensorSelector:(0,r._)((0,s._)({},i),{sensorName:n})}});switch(null==e?void 0:e.startSensor.__typename){case"Sensor":p({type:"update-success"});return;case"SensorNotFoundError":case"UnauthorizedError":case"PythonError":p({type:"update-error",name:n,error:e.startSensor.message})}break}case"schedule":{let{data:e}=await g({variables:{scheduleSelector:(0,r._)((0,s._)({},i),{scheduleName:n})}});switch(null==e?void 0:e.startSchedule.__typename){case"ScheduleStateResult":p({type:"update-success"});return;case"UnauthorizedError":case"PythonError":p({type:"update-error",name:n,error:e.startSchedule.message})}break}default:(0,y.dr)(o)}},E=async e=>{let{name:t,type:n,instigationState:s}=e,r={id:s.id};switch(n){case"sensor":{let{data:e}=await x({variables:r});switch(null==e?void 0:e.stopSensor.__typename){case"StopSensorMutationResult":p({type:"update-success"});return;case"UnauthorizedError":case"PythonError":p({type:"update-error",name:t,error:e.stopSensor.message})}break}case"schedule":{let{data:e}=await _({variables:r});switch(null==e?void 0:e.stopRunningSchedule.__typename){case"ScheduleStateResult":p({type:"update-success"});return;case"UnauthorizedError":case"PythonError":p({type:"update-error",name:t,error:e.stopRunningSchedule.message})}break}default:(0,y.dr)(n)}},N=async()=>{if("not-open"!==t){for(let e of(p({type:"start"}),a))"start"===t?await b(e):await E(e);p({type:"complete"})}},C="updating"!==c.step;return(0,o.jsxs)(v.lG,{isOpen:"not-open"!==t,title:"start"===t?"Start automations":"Stop automations",canEscapeKeyClose:C,canOutsideClickClose:C,onClose:n,children:[(0,o.jsx)(v.R4,{children:(0,o.jsxs)(i.a,{flex:{direction:"column",gap:24},children:[(()=>{if("not-open"===t)return null;switch(c.step){case"initial":if("stop"===t)return(0,o.jsx)("div",{children:"".concat(1===l?"1 automation":"".concat(l," automations")," will be stopped. Do you want to continue?")});return(0,o.jsx)("div",{children:"".concat(1===l?"1 automation":"".concat(l," automations")," will be started. Do you want to continue?")});case"updating":case"completed":let e=l>0?c.completion.completed/l:1;return(0,o.jsxs)(i.a,{flex:{direction:"column",gap:8},children:[(0,o.jsx)(f.z,{value:100*Math.max(.1,e),animate:e<1}),"updating"===c.step?(0,o.jsx)(I.M,{message:"Automations are being updated, please do not navigate away yet."}):null]});default:return null}})(),(()=>{if("not-open"===t||"initial"===c.step)return null;if("updating"===c.step)return(0,o.jsx)("div",{children:"Please do not close the window or navigate away while automations are being updated."});let e=c.completion.errors,n=Object.keys(e).length,s=c.completion.completed-n;return(0,o.jsxs)(i.a,{flex:{direction:"column",gap:8},children:[s?(0,o.jsxs)(i.a,{flex:{direction:"row",gap:8,alignItems:"flex-start"},children:[(0,o.jsx)(d.In,{name:"check_circle",color:u.P$()}),(0,o.jsx)("div",{children:"start"===t?"Successfully started ".concat(1===s?"1 automation":"".concat(s," automations"),"."):"Successfully stopped ".concat(1===s?"1 automation":"".concat(s," automations"),".")})]}):null,n?(0,o.jsxs)(i.a,{flex:{direction:"column",gap:8},children:[(0,o.jsxs)(i.a,{flex:{direction:"row",gap:8,alignItems:"flex-start"},children:[(0,o.jsx)(d.In,{name:"warning",color:u.Ym()}),(0,o.jsx)("div",{children:"start"===t?"Could not start ".concat(1===n?"1 automation":"".concat(n," automations"),":"):"Could not stop ".concat(1===n?"1 automation":"".concat(n," automations"),":")})]}),(0,o.jsx)("ul",{style:{margin:"8px 0"},children:Object.keys(e).map(t=>(0,o.jsx)("li",{children:(0,o.jsxs)(i.a,{flex:{direction:"row",gap:8},children:[(0,o.jsxs)("strong",{children:[t,":"]}),e[t]?(0,o.jsx)("div",{children:e[t]}):null]})},t))})]}):null]})})()]})}),(0,o.jsx)(v.Es,{children:(()=>{if("not-open"===t)return null;switch(c.step){case"initial":return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(j.$n,{onClick:n,children:"Cancel"}),(0,o.jsx)(j.$n,{intent:"primary",onClick:N,children:"start"===t?"Start ".concat(1===l?"1 automation":"".concat(l," automations")):"Stop ".concat(1===l?"1 automation":"".concat(l," automations"))})]});case"updating":return(0,o.jsx)(j.$n,{intent:"primary",disabled:!0,children:"start"===t?"Starting ".concat(1===l?"1 automation":"".concat(l," automations")):"Stopping ".concat(1===l?"1 automation":"".concat(l," automations"))});case"completed":return(0,o.jsx)(j.$n,{intent:"primary",onClick:n,children:"Done"})}})()})]})};var b=n(94251);let E=e=>{let{automations:t}=e,n=t.length,[s,r]=(0,h.useState)("not-open"),{anyOff:i,anyOn:a}=(0,h.useMemo)(()=>(e=>{let t=!1,n=!1;for(let s of e){let{status:e}=s;if(e===b.WqK.RUNNING?n=!0:e===b.WqK.STOPPED&&(t=!0),n&&t)break}return{anyOff:t,anyOn:n}})(t.map(e=>{let{instigationState:t}=e;return t})),[t]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(x.AM,{content:(0,o.jsxs)(g.W1,{children:[(0,o.jsx)(g.Dr,{text:"Start ".concat(1===n?"1 automation":"".concat(n," automations")),disabled:!i,"aria-disabled":!i,icon:"toggle_on",onClick:()=>{r("start")}}),(0,o.jsx)(g.Dr,{text:"Stop ".concat(1===n?"1 automation":"".concat(n," automations")),disabled:!a,"aria-disabled":!a,icon:"toggle_off",onClick:()=>{r("stop")}})]}),placement:"bottom-end",children:(0,o.jsx)(j.$n,{disabled:!n,intent:"primary",rightIcon:(0,o.jsx)(d.In,{name:"expand_more"}),children:"Actions"})}),(0,o.jsx)(_,{openWithIntent:s,automations:t,onClose:()=>r("not-open")})]})};var N=n(49147),C=n(93405),U=n(21440),$=n(92424),R=n(79240),M=n(81133),O=n(2830),F=n(22558),z=n(94675),L=n(61119),P=n(4533),D=n(38584),K=n(85184),q=n(71599),G=n(31158),H=n(91332),W=n(1214),B=n(56411),V=n.n(B);let Y=e=>{let{tick:t}=e,[n,s]=(0,h.useState)(!1);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(x.AM,{content:(()=>{if(!t)return(0,o.jsx)(i.a,{padding:{vertical:8,horizontal:12},children:(0,o.jsx)(c.HL,{children:"No ticks yet"})});let e=Q[t.status],n=(0,o.jsx)(H.D,{timestamp:{unix:t.timestamp}});switch(t.status){case b.lsI.FAILURE:return(0,o.jsx)(Z,{icon:e,title:"Latest tick failed",timestamp:n,content:(0,o.jsx)("div",{children:t.error?(0,o.jsx)(K.v,{onClick:()=>s(!0),children:"Show error"}):"Unknown error"})});case b.lsI.SUCCESS:{let s=t.runIds.length;return(0,o.jsx)(Z,{icon:e,title:"Latest tick succeeded",timestamp:n,content:(0,o.jsx)("div",{children:1===s?"1 run requested":"".concat(W.Eg.format(s)," runs requested")})})}case b.lsI.STARTED:return(0,o.jsx)(Z,{icon:e,title:"Evaluating tick",timestamp:n});case b.lsI.SKIPPED:default:var r;return(0,o.jsx)(Z,{icon:e,title:"Latest tick skipped",timestamp:n,content:(0,o.jsx)(c.HL,{children:null!=(r=t.skipReason)?r:"No reason provided"})})}})(),placement:"top",interactionKind:"hover",children:(0,o.jsx)(F.r,{children:t?Q[t.status]:(0,o.jsx)(d.In,{name:"missing",color:u.fR()})})}),(null==t?void 0:t.error)?(0,o.jsxs)(v.lG,{isOpen:n,title:"Error",style:{width:"80vw"},children:[(0,o.jsx)(v.R4,{children:(0,o.jsx)(G.Bf,{error:t.error})}),(0,o.jsx)(v.Es,{topBorder:!0,children:(0,o.jsx)(j.$n,{intent:"primary",onClick:()=>{s(!1)},children:"Done"})})]}):null]})},Q={[b.lsI.FAILURE]:(0,o.jsx)(d.In,{name:"warning",color:u.Ym()}),[b.lsI.SUCCESS]:(0,o.jsx)(d.In,{name:"done",color:u.P$()}),[b.lsI.STARTED]:(0,o.jsx)(q.y,{purpose:"body-text"}),[b.lsI.SKIPPED]:(0,o.jsx)(d.In,{name:"status",color:u.fR()})},Z=e=>{let{icon:t,title:n,timestamp:s,content:r}=e;return(0,o.jsxs)(i.a,{padding:12,className:V().hoverContent,children:[(0,o.jsxs)(i.a,{border:r?"bottom":void 0,padding:r?{bottom:12}:void 0,margin:r?{bottom:8}:void 0,flex:{direction:"row",alignItems:"center",gap:8,justifyContent:"space-between"},children:[(0,o.jsxs)(i.a,{flex:{direction:"row",alignItems:"center",gap:8},children:[t,(0,o.jsx)("div",{children:n})]}),(0,o.jsx)("div",{children:s})]}),r?(0,o.jsx)("div",{children:r}):null]})};var X=n(49575),J=n(82036),ee=n(18269),et=n(41735);let en=e=>{var t;let n=null==(t=Intl.DateTimeFormat(navigator.language,{timeZone:e,timeZoneName:"shortOffset"}).formatToParts(new Date).find(e=>"timeZoneName"===e.type))?void 0:t.value,s=null==n?void 0:n.replace("GMT","");if(!s)return 0;let[r="0",o="0"]=s.split(":"),i=parseInt(r,10),a=parseInt(o,10)/60*(i<0?-1:1);return i+a};var es=n(74053),er=n(6236),eo=n(41549);et.Ay.div.withConfig({componentId:"sc-fb93eb66-0"})([".bp5-popover-target{max-width:100%;:focus{outline:none;}}"]);var ei=n(12023),ea=n(56588),el=n(15992),ec=n(9329),ed=n(31210);n(59447);var eu=n(1536);n(49652),n(61011);var ep=n(97488),em=n(85521),eh=n(22812);n(36561),n(19366),n(64622);var ex=n(23298);function eg(){let e=(0,ec._)(["\n  query SingleScheduleQuery($selector: ScheduleSelector!) {\n    scheduleOrError(scheduleSelector: $selector) {\n      ... on Schedule {\n        id\n        name\n        pipelineName\n        description\n        scheduleState {\n          id\n          runningCount\n          hasStartPermission\n          hasStopPermission\n          ticks(limit: 1) {\n            id\n            ...TickTagFragment\n          }\n          runs(limit: 1) {\n            id\n            ...RunTimeFragment\n          }\n          nextTick {\n            timestamp\n          }\n        }\n        partitionSet {\n          id\n          name\n        }\n        ...ScheduleSwitchFragment\n      }\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return eg=function(){return e},e}let ej="1.2fr 1fr 1fr 76px 148px 210px 92px",ef="60px ".concat(ej);(0,et.Ay)(i.a).withConfig({componentId:"sc-750823c9-0"})(["display:grid;grid-template-columns:",";height:100%;"],e=>{let{$showCheckboxColumn:t}=e;return t?ef:ej});let ev=(0,S.J1)(eg(),ep.G0,em.vw,eh.M),eS=(0,h.forwardRef)((e,t)=>{var n,r,a;let{index:l,name:p,repoAddress:g,checked:j,onToggleChecked:f}=e,v=(0,R.V)(100),y=(0,S.IT)(ev,{variables:{selector:{repositoryName:g.name,repositoryLocationName:g.location,scheduleName:p}},skip:!v,notifyOnNetworkStatusChange:!0}),w=(0,S.IT)(ei.k,{variables:{scheduleSelector:{repositoryName:g.name,repositoryLocationName:g.location,scheduleName:p}},skip:!v});(0,X.Bj)(y,X.eO),(0,X.Bj)(w,X.eO);let{data:k}=y,I=(0,h.useMemo)(()=>(null==k?void 0:k.scheduleOrError.__typename)!=="Schedule"?null:k.scheduleOrError,[k]),T=null==I?void 0:I.scheduleState.ticks[0],{withHumanTimezone:A,withExecutionTimezone:_}=((e,t)=>{let{timezone:[n]}=(0,h.useContext)(er.RF);if(!e)return{withHumanTimezone:null,withExecutionTimezone:null};let s=t||"UTC",r=(0,es.d)(e,{longTimezoneName:s}),o="Automatic"===n?(0,eo.qi)():n,i=en(o),a=en(s);return{withHumanTimezone:(0,es.d)(e,{longTimezoneName:o,tzOffset:i-a}),withExecutionTimezone:r}})(null!=(n=null==I?void 0:I.cronSchedule)?n:null,null!=(r=null==I?void 0:I.executionTimezone)?r:null);return(0,o.jsx)(L.c,{ref:t,index:l,href:(0,eu.HG)(g,"/schedules/".concat(p)),checked:j,onToggle:f,renderLink:e=>{var{href:t}=e,n=(0,$._)(e,["href"]);return(0,o.jsx)(D.N_,(0,s._)({to:t||"#"},n))},left:(0,o.jsxs)(i.a,{flex:{direction:"row",gap:8,alignItems:"flex-start"},children:[(0,o.jsx)("div",{children:(0,o.jsx)(d.In,{name:"schedule"})}),(0,o.jsxs)(i.a,{flex:{direction:"column",gap:4},children:[(0,o.jsxs)(i.a,{flex:{direction:"row",gap:12,alignItems:"center"},children:[(0,o.jsx)(i.a,{flex:{direction:"row",gap:8,alignItems:"center"},children:p}),(null==I?void 0:I.description)?(0,o.jsx)(m.m,{content:(0,o.jsx)("div",{style:{maxWidth:320},children:I.description}),placement:"top",children:(0,o.jsx)(d.In,{name:"info",color:u.XN()})}):null]}),A?(0,o.jsxs)(c.Ub,{children:["Scheduled"," ",(0,o.jsx)(m.m,{placement:"top",content:(0,o.jsx)(P.mi,{rows:[{key:"Cron value",value:(0,o.jsx)(c.dC,{children:null!=(a=null==I?void 0:I.cronSchedule)?a:""})},{key:"Your time",value:(0,o.jsx)("span",{children:A})}]}),children:(0,o.jsx)("span",{children:_})})]}):(0,o.jsx)(M.E,{$width:80,$height:16})]})]}),right:(()=>{var e;if(y.loading&&!y.data)return(0,o.jsx)(M.E,{$width:200,$height:24});let t=(null==I?void 0:I.scheduleState.runs)||[];return(0,o.jsx)(O.p,{controls:[{key:"latest-run",control:(null==(e=t[0])?void 0:e.startTime)?(0,o.jsx)(x.AM,{position:"top",interactionKind:"hover",content:(0,o.jsx)("div",{children:(0,o.jsx)(ee._O,{run:t[0],name:p})}),hoverOpenDelay:100,children:(0,o.jsx)(F.r,{children:(0,o.jsxs)(i.a,{flex:{direction:"row",alignItems:"center",gap:8},children:[(0,o.jsx)(J.lQ,{status:t[0].status}),(0,o.jsx)(el.w,{unixTimestamp:t[0].startTime,showTooltip:!1})]})})},t[0].id):null},{key:"tick",control:(0,o.jsx)(Y,{tick:null!=T?T:null})},{key:"switch",control:(0,o.jsx)(i.a,{flex:{direction:"column",justifyContent:"center"},padding:{left:8},children:I?(0,o.jsx)(ea.G,{repoAddress:g,schedule:I},p):(0,o.jsx)(z.S,{disabled:!0,indeterminate:!0,checked:!1,format:"switch"},p)})}]})})()})});eS.displayName="ObserveAutomationScheduleRow";var ey=n(60974),ew=n(56091);n(90108);var ek=n(79188);function eI(){let e=(0,ec._)(["\n  query SingleSensorQuery($selector: SensorSelector!) {\n    sensorOrError(sensorSelector: $selector) {\n      ... on Sensor {\n        id\n        description\n        name\n        targets {\n          pipelineName\n        }\n        metadata {\n          assetKeys {\n            path\n          }\n        }\n        minIntervalSeconds\n        sensorState {\n          id\n          runningCount\n          hasStartPermission\n          hasStopPermission\n          ticks(limit: 1) {\n            id\n            ...TickTagFragment\n          }\n          runs(limit: 1) {\n            id\n            ...RunTimeFragment\n          }\n          nextTick {\n            timestamp\n          }\n        }\n        ...SensorSwitchFragment\n      }\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return eI=function(){return e},e}let eT="1.5fr 180px 1fr 76px 120px 148px 180px",eA="60px ".concat(eT);(0,et.Ay)(i.a).withConfig({componentId:"sc-64dc43b9-0"})(["display:grid;grid-template-columns:",";height:100%;"],e=>{let{$showCheckboxColumn:t}=e;return t?eA:eT});let e_={[b.$Up.ASSET]:{name:"Asset sensor",icon:"sensors",description:"Asset sensors instigate runs when a materialization occurs"},[b.$Up.AUTO_MATERIALIZE]:{name:"Automation condition sensor",icon:"automation_condition",description:"Automation condition sensors trigger runs based on conditions defined on assets or checks."},[b.$Up.AUTOMATION]:{name:"Automation condition sensor",icon:"automation_condition",description:"Automation condition sensors trigger runs based on conditions defined on assets or checks."},[b.$Up.FRESHNESS_POLICY]:{name:"Freshness policy sensor",icon:"sensors",description:"Freshness sensors check the freshness of assets on each tick, then perform an action in response to that status"},[b.$Up.MULTI_ASSET]:{name:"Multi-asset sensor",icon:"sensors",description:"Multi asset sensors trigger job executions based on multiple asset materialization event streams"},[b.$Up.RUN_STATUS]:{name:"Run status sensor",icon:"sensors",description:"Run status sensors react to run status"},[b.$Up.STANDARD]:{name:"Standard sensor",icon:"sensors",description:null},[b.$Up.UNKNOWN]:{name:"Standard sensor",icon:"sensors",description:null}},eb=(0,S.J1)(eI(),ep.G0,em.vw,ek.T),eE=(0,h.forwardRef)((e,t)=>{let{index:n,name:r,repoAddress:a,checked:l,onToggleChecked:p}=e,g=(0,R.V)(100),j=(0,S.IT)(eb,{variables:{selector:{repositoryName:a.name,repositoryLocationName:a.location,sensorName:r}},skip:!g}),f=(0,S.IT)(ey.X,{variables:{sensorSelector:{repositoryName:a.name,repositoryLocationName:a.location,sensorName:r}},skip:!g});(0,X.Bj)(j,X.eO),(0,X.Bj)(f,X.eO);let{data:v}=j,y=(0,h.useMemo)(()=>(null==v?void 0:v.sensorOrError.__typename)!=="Sensor"?null:v.sensorOrError,[v]),w=null==y?void 0:y.sensorState.ticks[0],k=(0,h.useMemo)(()=>{if(null==y?void 0:y.description)return y.description;let e=null==y?void 0:y.sensorType;return e?e_[e].description:null},[y]);return(0,o.jsx)(L.c,{ref:t,index:n,href:(0,eu.HG)(a,"/sensors/".concat(r)),checked:l,onToggle:p,renderLink:e=>{var{href:t}=e,n=(0,$._)(e,["href"]);return(0,o.jsx)(D.N_,(0,s._)({to:t||"#"},n))},left:(0,o.jsxs)(i.a,{flex:{direction:"row",gap:8,alignItems:"flex-start"},children:[(0,o.jsx)("div",{children:(0,o.jsx)(d.In,{name:"sensors"})}),(0,o.jsxs)(i.a,{flex:{direction:"column",gap:4},children:[(0,o.jsxs)(i.a,{flex:{direction:"row",gap:12,alignItems:"center"},children:[r,k?(0,o.jsx)(m.m,{content:(0,o.jsx)("div",{style:{maxWidth:320},children:k}),placement:"top",children:(0,o.jsx)(d.In,{name:"info",color:u.XN()})}):null]}),(0,o.jsx)(c.Ub,{children:(null==y?void 0:y.sensorType)?eN[y.sensorType]:(0,o.jsx)(M.E,{$width:80,$height:16})})]})]}),right:(()=>{var e;if(j.loading&&!j.data)return(0,o.jsx)(M.E,{$width:200,$height:24});let t=(null==y?void 0:y.sensorState.runs)||[];return(0,o.jsx)(O.p,{controls:[{key:"latest-run",control:(null==(e=t[0])?void 0:e.startTime)?(0,o.jsx)(x.AM,{position:"top",interactionKind:"hover",content:(0,o.jsx)("div",{children:(0,o.jsx)(ee._O,{run:t[0],name:r})}),hoverOpenDelay:100,children:(0,o.jsx)(F.r,{children:(0,o.jsxs)(i.a,{flex:{direction:"row",alignItems:"center",gap:8},children:[(0,o.jsx)(J.lQ,{status:t[0].status}),(0,o.jsx)(el.w,{unixTimestamp:t[0].startTime,showTooltip:!1})]})})},t[0].id):null},{key:"tick",control:(0,o.jsx)(Y,{tick:null!=w?w:null})},{key:"switch",control:(0,o.jsx)(i.a,{flex:{direction:"column",justifyContent:"center"},padding:{left:8},children:y?(0,o.jsx)(ew.z,{repoAddress:a,sensor:y},r):(0,o.jsx)(z.S,{disabled:!0,indeterminate:!0,checked:!1,format:"switch"},r)})}]})})()})});eE.displayName="ObserveAutomationSensorRow";let eN={[b.$Up.ASSET]:"Asset sensor",[b.$Up.AUTOMATION]:"Automation condition sensor",[b.$Up.AUTO_MATERIALIZE]:"Automation condition sensor",[b.$Up.FRESHNESS_POLICY]:"Freshness policy sensor",[b.$Up.MULTI_ASSET]:"Multi-asset sensor",[b.$Up.RUN_STATUS]:"Run status sensor",[b.$Up.STANDARD]:"Standard sensor",[b.$Up.UNKNOWN]:"Unknown sensor type"};var eC=n(25243),eU=n(94543);let e$=(e,t)=>"".concat((0,eU.FC)(e),"-").concat(t);var eR=n(32411),eM=n(10690);let eO=e=>{let{repos:t,checkedKeys:n,onToggleCheckFactory:s}=e,r=h.useRef(null),i=h.useMemo(()=>t.map(e=>{let{repoAddress:t}=e;return(0,eU.FC)(t)}),[t]),{expandedKeys:a,onToggle:l,onToggleAll:c}=(0,eM.A)(eC.i,i),d=h.useMemo(()=>{let e=[];return t.forEach(t=>{let{repoAddress:n,schedules:s,sensors:r}=t;e.push({type:"header",repoAddress:n,scheduleCount:s.length,sensorCount:r.length});let o=(0,eU.FC)(n);if(a.includes(o)){let t=new Set(r),o=new Set(s);[...r,...s].sort((e,t)=>y.Vp.compare(e,t)).forEach(s=>{t.has(s)?e.push({type:"sensor",repoAddress:n,sensor:s}):o.has(s)&&e.push({type:"schedule",repoAddress:n,schedule:s})})}}),e},[t,a]),u=(0,eR.F)(t.map(e=>{let{repoAddress:t}=e;return t.name})),p=(0,U.Te)({count:d.length,getScrollElement:()=>r.current,estimateSize:e=>{let t=d[e];return(null==t?void 0:t.type)==="header"?32:62},overscan:15}),m=p.getTotalSize(),x=p.getVirtualItems();return(0,o.jsx)("div",{style:{overflow:"hidden"},children:(0,o.jsx)(ex.mc,{ref:r,children:(0,o.jsx)(ex.Rp,{$totalHeight:m,children:x.map(e=>{let{index:t,key:r,size:i,start:m}=e,h=d[t],x=h.type;if("header"===x)return(0,o.jsx)(C.fI,{$height:i,$start:m,children:(0,o.jsx)(ed.ur,{repoAddress:h.repoAddress,ref:p.measureElement,index:t,onToggle:l,onToggleAll:c,expanded:a.includes((0,eU.FC)(h.repoAddress)),showLocation:u.has(h.repoAddress.name),rightElement:(0,o.jsx)(o.Fragment,{})})},r);if("sensor"===x){let e=e$(h.repoAddress,h.sensor);return(0,o.jsx)(C.fI,{$height:i,$start:m,children:(0,o.jsx)(eE,{index:t,ref:p.measureElement,name:h.sensor,checked:n.has(e),onToggleChecked:s(e),repoAddress:h.repoAddress},r)},r)}if("schedule"===x){let e=e$(h.repoAddress,h.schedule);return(0,o.jsx)(C.fI,{$height:i,$start:m,children:(0,o.jsx)(eS,{index:t,ref:p.measureElement,name:h.schedule,checked:n.has(e),onToggleChecked:s(e),repoAddress:h.repoAddress},r)},r)}return(0,o.jsx)("div",{},r)})})})})};var eF=n(70830),ez=n(10570),eL=n(43052),eP=n(11887),eD=n(51341),eK=n(20881),eq=n(80300),eG=n(67038);let eH=e=>e.hasStartPermission&&e.status===b.WqK.STOPPED||e.hasStopPermission&&e.status===b.WqK.RUNNING;var eW=n(33469);let eB=()=>{(0,ez.b7)(),(0,eK.r)("Automation");let e=(0,eL.I)(),{automations:t,repoBuckets:n,loading:x}=(0,eF.M)(),[g,j]=(0,eq.m)({queryKey:"selection",defaults:{selection:""},behavior:"push"}),f=(0,h.useMemo)(()=>(0,eP.N)(t,g),[t,g]),v=(0,h.useMemo)(()=>n.filter(e=>Array.from(f).some(t=>t.repo.name===e.repoAddress.name&&t.repo.location===e.repoAddress.location)).map(e=>(0,r._)((0,s._)({},e),{schedules:e.schedules.filter(e=>f.has(e)),sensors:e.sensors.filter(e=>f.has(e))})).filter(e=>!!e.schedules.length||!!e.sensors.length),[n,f]),S=(0,h.useMemo)(()=>v.map(e=>{let{repoAddress:t,schedules:n,sensors:s}=e;return[...s.filter(e=>{let{sensorState:t}=e;return eH(t)}).map(e=>{let{name:n,sensorState:s}=e;return{repoAddress:t,name:n,type:"sensor",instigationState:s}}),...n.filter(e=>{let{scheduleState:t}=e;return eH(t)}).map(e=>{let{name:n,scheduleState:s}=e;return{repoAddress:t,name:n,type:"schedule",instigationState:s}})]}).flat(),[v]),y=(0,h.useMemo)(()=>S.map(e=>{let{repoAddress:t,name:n}=e;return e$(t,n)}),[S]),[{checkedIds:w},{onToggleFactory:k,onToggleAll:I}]=(0,eG._)(y),T=(0,h.useMemo)(()=>{let e=new Set(v.map(e=>{let{repoAddress:t,schedules:n,sensors:s}=e;return[...n,...s].map(e=>{let{name:n}=e;return e$(t,n)})}).flat());return y.filter(t=>e.has(t))},[y,v]),A=(0,h.useMemo)(()=>{let e=new Set(T.filter(e=>w.has(e)));return S.filter(t=>{let{repoAddress:n,name:s}=t;return e.has(e$(n,s))})},[T,S,w]),_=y.length>0,b=A.length,C=T.length>0,U=(0,h.useMemo)(()=>v.map(e=>({repoAddress:e.repoAddress,schedules:e.schedules.map(e=>e.name),sensors:e.sensors.map(e=>e.name)})),[v]);return(0,o.jsxs)(i.a,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,o.jsx)(p.z,{title:(0,o.jsx)(c.M7,{children:"Automation"})}),"has-global-amp"===e?(0,o.jsx)(i.a,{padding:{horizontal:24},border:"bottom",children:(0,o.jsx)(N.M,{tab:"schedules-and-sensors"})}):null,(0,o.jsxs)(i.a,{padding:{horizontal:24,vertical:12},flex:{direction:"row",alignItems:"center",justifyContent:"space-between",gap:12,grow:0},children:[(0,o.jsx)(i.a,{flex:{grow:1},children:(0,o.jsx)(eD.G,{items:t,value:g,onChange:j})}),(0,o.jsx)(m.m,{content:"You do not have permission to start or stop these schedules",canShow:C&&!_,placement:"top-end",children:(0,o.jsx)(E,{automations:A})})]}),x?(0,o.jsx)(i.a,{flex:{direction:"row",justifyContent:"center"},padding:{top:64},children:(0,o.jsx)(a.V,{label:"Loading automationsâ€¦"})}):0===v.length?g?(0,o.jsx)(i.a,{padding:{top:20},children:(0,o.jsx)(l.I,{icon:"search",title:"No matching automations",description:(0,o.jsxs)("div",{children:["No automations matching ",(0,o.jsx)("strong",{children:g})," were found in your definitions"]})})}):(0,o.jsx)(i.a,{padding:{top:20},children:(0,o.jsx)(l.I,{icon:"search",title:"No automations",description:(0,o.jsxs)(c.jz,{children:["There are no automations in this deployment."," ",(0,o.jsx)("a",{href:"https://docs.dagster.io/concepts/automation",target:"_blank",rel:"noreferrer",children:(0,o.jsxs)(i.a,{flex:{direction:"row",gap:4,alignItems:"center"},children:["Learn more about automations",(0,o.jsx)(d.In,{name:"open_in_new",color:u.Hv()})]})})]})})}):(0,o.jsx)(eO,{headerCheckbox:_?(0,o.jsx)(eW.t,{checkedCount:b,totalCount:T.length,onToggleAll:I}):void 0,repos:U,checkedKeys:w,onToggleCheckFactory:k})]})},eV=eB},49147:(e,t,n)=>{"use strict";n.d(t,{M:()=>u});var s=n(6029),r=n(21316),o=n(34419),i=n(71599),a=n(36660),l=n(43052),c=n(11441),d=n(48780);let u=e=>{let{tab:t}=e,n=(0,c.Aw)(),u=(0,l.I)();return(0,s.jsxs)(r.tU,{selectedTabId:t,children:[(0,s.jsx)(d.s,{id:"schedules-and-sensors",title:"Schedules and sensors",to:"/automation"}),"has-global-amp"===u?(0,s.jsx)(d.s,{id:"global-amp",title:(0,s.jsxs)(o.a,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,s.jsx)("div",{children:"Auto-materialize"}),n.loading?(0,s.jsx)(i.y,{purpose:"body-text"}):(0,s.jsx)("div",{style:{width:"10px",height:"10px",borderRadius:"50%",backgroundColor:!1===n.paused?a.iZ():a.fR()}})]}),to:"/overview/automation"}):null]})}},56411:e=>{e.exports={hoverContent:"LatestTickHoverButton_hoverContent__4QRVM"}}}]);
//# sourceMappingURL=479.90ba2ab7dbd10931.js.map