"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[794],{13365:(e,n,t)=>{t.d(n,{Y:()=>r});let r=t(41735).Ay.div.withConfig({componentId:"sc-2cf5acf-0"})(["height:100%;overflow-y:auto;padding-bottom:64px;width:100%;"])},45313:(e,n,t)=>{t.d(n,{Xg:()=>a,bV:()=>u,kb:()=>d,sP:()=>x});var r=t(9329),i=t(98784);function s(){let e=(0,r._)(["\n  mutation SetConcurrencyLimit($concurrencyKey: String!, $limit: Int!) {\n    setConcurrencyLimit(concurrencyKey: $concurrencyKey, limit: $limit)\n  }\n"]);return s=function(){return e},e}function o(){let e=(0,r._)(["\n  mutation DeleteConcurrencyLimit($concurrencyKey: String!) {\n    deleteConcurrencyLimit(concurrencyKey: $concurrencyKey)\n  }\n"]);return o=function(){return e},e}function l(){let e=(0,r._)(["\n  mutation FreeConcurrencySlots($runId: String!, $stepKey: String) {\n    freeConcurrencySlots(runId: $runId, stepKey: $stepKey)\n  }\n"]);return l=function(){return e},e}function c(){let e=(0,r._)(["\n  query RunsForConcurrencyKeyQuery($filter: RunsFilter, $limit: Int) {\n    pipelineRunsOrError(filter: $filter, limit: $limit) {\n      ... on Runs {\n        results {\n          id\n          status\n        }\n      }\n    }\n  }\n"]);return c=function(){return e},e}let a=(0,i.J1)(s()),d=(0,i.J1)(o()),u=(0,i.J1)(l()),x=(0,i.J1)(c())},63794:(e,n,t)=>{t.r(n),t.d(n,{ConcurrencyLimits:()=>eC,INSTANCE_CONCURRENCY_LIMITS_QUERY:()=>eS,InstanceConcurrencyIndexContent:()=>ep,InstanceConcurrencyPage:()=>ej,InstanceConcurrencyPageContent:()=>em,RunConcurrencyContent:()=>eg,default:()=>ey});var r=t(9329),i=t(6029),s=t(34419),o=t(62978),l=t(13365),c=t(71802),a=t(67221),d=t(4533),u=t(12547),x=t(85184),h=t(46371),m=t(9448),p=t(97962),j=t(74016),y=t(63018),g=t(55729),f=t(3102),C=t(21316);let b=e=>{let{activeTab:n,onChange:t}=e;return(0,i.jsxs)(C.tU,{selectedTabId:n,onChange:t,children:[(0,i.jsx)(C.oz,{title:"Pools",id:"key-concurrency",selected:"key-concurrency"===n}),(0,i.jsx)(C.oz,{title:"Run tag concurrency",id:"run-concurrency",selected:"run-concurrency"===n})]})};var v=t(82343),I=t(98689),S=t(91118),w=t(36660),R=t(27589),K=t(26020),k=t(38584),_=t(98784),L=t(45313),T=t(99082),$=t(10570),F=t(46984),N=t(50170),Q=t(90713),A=t(49575),V=t(94251),z=t(20881),E=t(82036),P=t(95510),D=t(85521),U=t(56524);let q=e=>{var n,t;let{concurrencyKey:r}=e;(0,$.b7)(),(0,z.r)("Pool: ".concat(r));let[l,c]=g.useState(),[u,x]=g.useState(!1),h=(0,_.IT)(T.Z,{variables:{pool:r}}),{data:j,refetch:y}=h,C=null==j?void 0:j.instance.concurrencyLimit,b=null==j?void 0:j.instance.runQueuingSupported,R=(0,A.Bj)(h,A.eO),K=(0,f.W6)(),L=null==j||null==(n=j.instance.poolConfig)?void 0:n.poolGranularity;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{overflowY:"auto"},children:C?(0,i.jsxs)(s.a,{children:[(0,i.jsxs)(s.a,{padding:{vertical:16,horizontal:24},flex:{direction:"row",alignItems:"center",justifyContent:"space-between"},border:"bottom",children:[(0,i.jsx)(a.DZ,{children:(0,i.jsxs)(s.a,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,i.jsx)("div",{children:(0,i.jsx)(k.N_,{to:"/deployment/concurrency",children:"Pools"})}),(0,i.jsx)("div",{children:"/"}),(0,i.jsx)("div",{children:r})]})}),(0,i.jsxs)(s.a,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,i.jsx)(A.D7,{refreshState:R}),(0,i.jsx)(v.AM,{position:"bottom-right",content:(0,i.jsx)(I.W1,{children:(0,i.jsx)(I.Dr,{icon:"delete",text:"Delete",intent:"danger",onClick:()=>x(!0)})}),children:(0,i.jsx)(m.$n,{icon:(0,i.jsx)(p.In,{name:"expand_more"})})})]})]}),(0,i.jsx)(s.a,{padding:{vertical:16,horizontal:24},children:(0,i.jsx)(a.R2,{children:"Pool info"})}),b||"op"===L?null:(0,i.jsx)(s.a,{margin:{horizontal:20,bottom:20},children:(0,i.jsx)(S.F,{intent:"warning",title:"Run granularity for pools not supported",description:(0,i.jsxs)(i.Fragment,{children:["The pool granularity is set to ",(0,i.jsx)(a.Kp,{children:"run"}),", but run-level concurrency is not supported with this run coordinator. To enable run granularity for pools, configure your instance to use the default ",(0,i.jsx)(a.Kp,{children:"QueuedRunCoordinator"})," ","in your ",(0,i.jsx)(a.Kp,{children:"dagster.yaml"}),". See the"," ",(0,i.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://docs.dagster.io/deployment/dagster-instance#queuedruncoordinator",children:"QueuedRunCoordinator documentation"})," ","for more information."]})})}),(0,i.jsx)(s.a,{padding:{bottom:24},children:(0,i.jsx)(d.Wy,{style:{marginLeft:-1},children:(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{verticalAlign:"middle"},children:"Granularity"}),(0,i.jsx)("td",{children:"run"===L?"Run":"Op"})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{style:{verticalAlign:"middle"},children:"Limit"}),(0,i.jsx)("td",{children:(0,i.jsxs)(s.a,{flex:{justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)(s.a,{flex:{direction:"row",gap:8,alignItems:"center"},children:[(0,i.jsx)("div",{children:C.slotCount?C.slotCount:null===C.limit?(0,i.jsx)(i.Fragment,{children:"—"}):C.limit}),C.usingDefaultLimit?(0,i.jsx)(a.HL,{color:w._l(),children:"(default)"}):null]}),(0,i.jsx)(m.$n,{icon:(0,i.jsx)(p.In,{name:"edit"}),onClick:()=>c(!0),children:"Edit limit"})]})})]})]})})}),(null==j||null==(t=j.instance.poolConfig)?void 0:t.poolGranularity)!=="run"?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.a,{padding:{vertical:16,horizontal:24},flex:{direction:"row",alignItems:"center",justifyContent:"space-between"},children:(0,i.jsx)(a.R2,{children:"In progress steps"})}),(0,i.jsx)(s.a,{style:{marginLeft:-1},children:(0,i.jsx)(M,{keyInfo:C,refresh:y})}),(0,i.jsx)(s.a,{padding:{vertical:16,horizontal:24},flex:{direction:"row",alignItems:"center",justifyContent:"space-between"},children:(0,i.jsx)(a.R2,{children:"Queued runs"})}),(0,i.jsx)(G,{pool:r,runStatuses:F.Ii})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.a,{padding:{vertical:16,horizontal:24},flex:{direction:"row",alignItems:"center",justifyContent:"space-between"},children:(0,i.jsx)(a.R2,{children:"In progress"})}),(0,i.jsx)(G,{pool:r,runStatuses:F.Tk}),(0,i.jsx)(s.a,{padding:{vertical:16,horizontal:24},flex:{direction:"row",alignItems:"center",justifyContent:"space-between"},children:(0,i.jsx)(a.R2,{children:"Queued"})}),(0,i.jsx)(G,{pool:r,runStatuses:F.Ii})]})]}):(0,i.jsx)(s.a,{flex:{direction:"column",alignItems:"center"},padding:{vertical:64},children:(0,i.jsx)(o.V,{label:"Loading…"})})}),(0,i.jsx)(Y,{concurrencyKey:r,open:!!l,onClose:()=>c(!1),onComplete:y,minValue:(null==j?void 0:j.instance.minConcurrencyLimitValue)||0,maxValue:(null==j?void 0:j.instance.maxConcurrencyLimitValue)||1e3}),(0,i.jsx)(W,{concurrencyKey:r,open:!!u,onClose:()=>x(!1),onComplete:()=>{K.push("/deployment/concurrency"),(0,Q.l)({icon:"trash",intent:"success",message:"Deleted pool limit"})}})]})},O=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;if(!e)return!1;let r=parseInt(e);return!isNaN(r)&&String(r)===e.trim()&&r>=n&&r<=t},Y=e=>{let{concurrencyKey:n,open:t,onClose:r,onComplete:o,minValue:l,maxValue:c}=e,[d,u]=g.useState(!1),[x,p]=g.useState("");g.useEffect(()=>{p("")},[t]);let[y]=(0,_.n_)(L.Xg),f=async()=>{u(!0),await y({variables:{concurrencyKey:n,limit:parseInt(x.trim())}}),u(!1),o(),r()};return(0,i.jsxs)(j.lG,{isOpen:t,title:(0,i.jsxs)("span",{children:["Edit ",(0,i.jsx)(a.Kp,{children:n})]}),onClose:r,children:[(0,i.jsxs)(j.R4,{children:[(0,i.jsx)(s.a,{margin:{bottom:4},children:"Pool:"}),(0,i.jsx)(s.a,{margin:{bottom:16},children:(0,i.jsx)("strong",{children:n})}),(0,i.jsxs)(s.a,{margin:{bottom:4},children:["Pool limit (",l,"-",c,"):"]}),(0,i.jsx)(s.a,{children:(0,i.jsx)(h.k,{value:x||"",onChange:e=>p(e.target.value),placeholder:"".concat(l," - ").concat(c)})})]}),(0,i.jsxs)(j.Es,{children:[(0,i.jsx)(m.$n,{intent:"none",onClick:r,children:"Close"}),d?(0,i.jsx)(m.$n,{intent:"primary",disabled:!0,children:"Updating…"}):(0,i.jsx)(m.$n,{intent:"primary",onClick:f,disabled:!O(x.trim(),l,c),children:"Update limit"})]})]})},W=e=>{let{concurrencyKey:n,open:t,onClose:r,onComplete:s}=e,[o,l]=g.useState(!1),[c]=(0,_.n_)(L.kb),d=async()=>{l(!0),await c({variables:{concurrencyKey:n}}),l(!1),s(),r()},u=(0,i.jsxs)(i.Fragment,{children:["Delete ",(0,i.jsx)(a.Kp,{children:n})]});return(0,i.jsxs)(j.lG,{isOpen:t,title:u,onClose:r,children:[(0,i.jsxs)(j.R4,{children:["Delete concurrency limit\xa0",(0,i.jsx)("strong",{children:n}),"?"]}),(0,i.jsxs)(j.Es,{children:[(0,i.jsx)(m.$n,{onClick:r,children:"Close"}),(0,i.jsx)(m.$n,{intent:"danger",disabled:o,onClick:d,children:o?"Deleting…":"Delete limit"})]})]})},J=e=>{let{pendingStep:n,onUpdate:t}=e,[r]=(0,_.n_)(L.bV);return(0,i.jsx)(v.AM,{content:(0,i.jsxs)(I.W1,{children:[(0,i.jsx)(I.Dr,{icon:"status",text:"Free concurrency slot for step",onClick:async()=>{var e;(null==(e=(await r({variables:{runId:n.runId,stepKey:n.stepKey}})).data)?void 0:e.freeConcurrencySlots)&&(t(),await (0,Q.l)({intent:"success",icon:"copy_to_clipboard_done",message:"Freed concurrency slot"}))}},"free-concurrency-slots-step"),(0,i.jsx)(I.Dr,{icon:"status",text:"Free all concurrency slots for run",onClick:async()=>{var e;await (0,Q.l)({intent:"primary",message:"Freeing concurrency slots..."}),(null==(e=(await r({variables:{runId:n.runId}})).data)?void 0:e.freeConcurrencySlots)&&(t(),await (0,Q.l)({intent:"success",icon:"copy_to_clipboard_done",message:"Freed concurrency slots"}))}},"free-concurrency-slots-run")]}),position:"bottom-right",children:(0,i.jsx)(m.$n,{rightIcon:(0,i.jsx)(p.In,{name:"expand_more"}),children:"Actions"})})},G=e=>{let{pool:n,runStatuses:t}=e,r={statuses:Array.from(t),tags:[{key:"".concat(P.d.PoolTagPrefix,"/").concat(n),value:"true"}]};return(0,i.jsx)(N.U,{filter:r,includeRunsFromBackfills:!0,emptyState:()=>(0,i.jsx)(s.a,{padding:{vertical:24},flex:{direction:"column",alignItems:"center"},children:t.has(V.i2_.STARTED)?"No matching runs in progress.":"No matching runs in queue."})})},M=e=>{var n;let{keyInfo:t,refresh:r}=e,o=[...new Set(t.pendingSteps.map(e=>e.runId))],l=(0,_.IT)(L.sP,{variables:{filter:{runIds:o}},skip:!t.pendingSteps.length}),c={};((null==(n=l.data)?void 0:n.pipelineRunsOrError.__typename)==="Runs"?l.data.pipelineRunsOrError.results:[]).forEach(e=>{c[e.id]=e.status});let a=[...t.pendingSteps];a.sort((e,n)=>e.priority&&n.priority&&e.priority!==n.priority?e.priority-n.priority:e.enqueuedTimestamp-n.enqueuedTimestamp);let d=a.filter(e=>!!e.assignedTimestamp),x=a.filter(e=>!e.assignedTimestamp),h=(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Run ID"}),(0,i.jsx)("th",{children:"Step key"}),(0,i.jsx)("th",{children:"Assigned"}),(0,i.jsx)("th",{children:"Queued"}),(0,i.jsx)("th",{children:(0,i.jsxs)(s.a,{flex:{alignItems:"center",direction:"row",gap:4},children:["Priority",(0,i.jsx)(R.m,{placement:"top",content:"Priority can be set on each op/asset using the 'dagster/priority' tag. Higher priority steps will be assigned slots first.",children:(0,i.jsx)(p.In,{name:"info",color:w.fR()})})]})}),(0,i.jsx)("th",{})]})});return a.length?(0,i.jsxs)(K.X,{children:[h,(0,i.jsx)("tbody",{style:{backgroundColor:w.ao()},children:d.map(e=>(0,i.jsx)(B,{step:e,statusByRunId:c,onUpdate:r},e.runId+e.stepKey))}),(0,i.jsx)("tbody",{children:x.map(e=>(0,i.jsx)(B,{step:e,statusByRunId:c,onUpdate:r},e.runId+e.stepKey))})]}):(0,i.jsx)(u.I,{icon:"no-results",title:"No active steps",description:"There are no active or pending steps for this pool."})},B=e=>{let{step:n,statusByRunId:t,onUpdate:r}=e,o=t[n.runId];return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:o?(0,i.jsx)(k.N_,{to:"/runs/".concat(n.runId),children:(0,i.jsxs)(s.a,{flex:{direction:"row",alignItems:"center",gap:8},children:[(0,i.jsx)(E.vA,{status:o,size:10}),(0,i.jsx)(a.Kp,{children:(0,D.fb)({id:n.runId})}),F.ev.has(o)?(0,i.jsx)(R.m,{placement:"top",content:"Slots for canceled / failed runs can automatically be freed by configuring a run monitoring setting.",children:(0,i.jsx)(p.In,{name:"info",color:w.fR()})}):null]})}):(0,i.jsx)(a.Kp,{children:(0,D.fb)({id:n.runId})})}),(0,i.jsx)("td",{children:(0,i.jsx)(a.Kp,{children:n.stepKey})}),(0,i.jsx)("td",{children:n.assignedTimestamp?(0,i.jsx)(U.W,{startUnix:n.assignedTimestamp,endUnix:null}):"-"}),(0,i.jsx)("td",{children:n.enqueuedTimestamp?(0,i.jsx)(U.W,{startUnix:n.enqueuedTimestamp,endUnix:null}):"-"}),(0,i.jsx)("td",{children:n.priority}),(0,i.jsx)("td",{children:(0,i.jsx)(J,{pendingStep:n,onUpdate:r})})]})};var X=t(87771),H=t(75575),Z=t(79240),ee=t(21440),en=t(41735),et=t(23298),er=t(31210);function ei(){let e=(0,r._)(["\n  query SingleConcurrencyKeyQuery($concurrencyKey: String!) {\n    instance {\n      id\n      concurrencyLimit(concurrencyKey: $concurrencyKey) {\n        concurrencyKey\n        slotCount\n        claimedSlots {\n          runId\n          stepKey\n        }\n        pendingSteps {\n          runId\n          stepKey\n          enqueuedTimestamp\n          assignedTimestamp\n          priority\n        }\n      }\n    }\n  }\n"]);return ei=function(){return e},e}let es="1fr 1fr",eo=e=>{let{concurrencyKeys:n}=e,t=(0,g.useRef)(null),r=(0,ee.Te)({count:n.length,getScrollElement:()=>t.current,estimateSize:()=>64,overscan:10}),s=r.getTotalSize(),o=r.getVirtualItems();return(0,i.jsx)("div",{style:{overflow:"hidden"},children:(0,i.jsxs)(et.mc,{ref:t,children:[(0,i.jsx)(el,{}),(0,i.jsx)(et.Rp,{$totalHeight:s,children:o.map(e=>{let{index:t,key:r,size:s,start:o}=e,l=n[t];return(0,i.jsx)(ec,{concurrencyKey:l,height:s,start:o},r)})})]})})},el=()=>(0,i.jsxs)(et.Sy,{templateColumns:es,sticky:!0,children:[(0,i.jsx)(et.A3,{children:"Pool"}),(0,i.jsx)(et.A3,{children:"Limit"})]}),ec=e=>{let{concurrencyKey:n,height:t,start:r}=e,o=(0,Z.V)(100),l=(0,_.IT)(ea,{variables:{concurrencyKey:n},skip:!o});(0,A.Bj)(l,A.eO);let{data:c}=l,a=null==c?void 0:c.instance.concurrencyLimit,d="/deployment/concurrency/".concat(encodeURIComponent(n));return(0,i.jsx)(et.fI,{$height:t,$start:r,children:(0,i.jsxs)(ed,{border:"bottom",children:[(0,i.jsx)(et.$4,{children:(0,i.jsxs)(s.a,{flex:{gap:4,alignItems:"center"},children:[(0,i.jsx)(p.In,{name:"dynamic_feed"}),(0,i.jsx)(k.N_,{to:d,children:n})]})}),(0,i.jsx)(et.$4,{children:a?(0,i.jsx)("div",{children:a.slotCount}):(0,i.jsx)(er.ov,{queryResult:l})})]})})},ea=(0,_.J1)(ei()),ed=(0,en.Ay)(s.a).withConfig({componentId:"sc-ae8acd8d-0"})(["display:grid;grid-template-columns:",";height:100%;"],es);var eu=t(8131);function ex(){let e=(0,r._)(["\n  fragment RunQueueConfigFragment on RunQueueConfig {\n    maxConcurrentRuns\n    tagConcurrencyLimitsYaml\n  }\n"]);return ex=function(){return e},e}function eh(){let e=(0,r._)(["\n  query InstanceConcurrencyLimitsQuery {\n    instance {\n      id\n      supportsConcurrencyLimits\n      runQueuingSupported\n      runQueueConfig {\n        ...RunQueueConfigFragment\n      }\n      minConcurrencyLimitValue\n      maxConcurrencyLimitValue\n      concurrencyLimits {\n        concurrencyKey\n      }\n    }\n  }\n\n  ","\n"]);return eh=function(){return e},e}let em=g.memo(()=>{let{concurrencyKey:e}=(0,f.g)();if(!e)return(0,i.jsx)(ep,{});let n=decodeURIComponent(e);return(0,i.jsx)(q,{concurrencyKey:n})}),ep=g.memo(()=>{(0,$.b7)(),(0,z.r)("Concurrency");let e=(0,_.IT)(eS,{notifyOnNetworkStatusChange:!0}),[n,t]=g.useState("key-concurrency"),{data:r}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ef,{activeTab:n,onChange:t}),r?"run-concurrency"===n?(0,i.jsx)("div",{style:{overflowY:"auto"},children:(0,i.jsx)(eg,{hasRunQueue:!!(null==r?void 0:r.instance.runQueuingSupported),runQueueConfig:null==r?void 0:r.instance.runQueueConfig})}):(0,i.jsx)("div",{style:{overflowY:"hidden"},children:(0,i.jsx)(eC,{concurrencyKeys:r.instance.concurrencyLimits.map(e=>e.concurrencyKey),hasSupport:r.instance.supportsConcurrencyLimits,refetch:e.refetch,minValue:r.instance.minConcurrencyLimitValue,maxValue:r.instance.maxConcurrencyLimitValue})}):(0,i.jsx)(s.a,{padding:{vertical:64},flex:{direction:"column",alignItems:"center"},children:(0,i.jsx)(o.V,{label:"Loading concurrency information…"})})]})}),ej=()=>{let{pageTitle:e}=g.useContext(X.y);return(0,i.jsxs)(l.Y,{style:{padding:0},children:[(0,i.jsx)(c.z,{title:(0,i.jsx)(a.M7,{children:e}),tabs:(0,i.jsx)(H.q,{tab:"concurrency"})}),(0,i.jsx)(ep,{})]})},ey=ej,eg=e=>{let{hasRunQueue:n,runQueueConfig:t}=e;if(!n)return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.a,{padding:{vertical:16,horizontal:24},border:"bottom",flex:{direction:"row",alignItems:"center",justifyContent:"space-between"},children:(0,i.jsx)(a.R2,{children:"Run tag concurrency"})}),(0,i.jsxs)(s.a,{padding:{vertical:16,horizontal:24},children:["Run concurrency is not supported with this run coordinator. To enable run concurrency limits, configure your instance to use the ",(0,i.jsx)(a.Kp,{children:"QueuedRunCoordinator"})," in your"," ",(0,i.jsx)(a.Kp,{children:"dagster.yaml"}),". See the"," ",(0,i.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://docs.dagster.io/deployment/dagster-instance#queuedruncoordinator",children:"QueuedRunCoordinator documentation"})," ","for more information."]})]});let r=(0,i.jsxs)(s.a,{padding:{vertical:24,horizontal:24},children:["Run tag concurrency can be set in your deployment settings. See the"," ",(0,i.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://docs.dagster.io/guides/limiting-concurrency-in-data-pipelines#configuring-run-level-concurrency",children:"concurrency documentation"})," ","for more information."]}),o=t?(0,i.jsx)(d.Wy,{style:{marginLeft:-1},children:(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Max concurrent runs:"}),(0,i.jsx)("td",{children:t.maxConcurrentRuns})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Tag concurrency limits:"}),(0,i.jsx)("td",{children:t.tagConcurrencyLimitsYaml?(0,i.jsx)(y.O,{value:t.tagConcurrencyLimitsYaml,options:{readOnly:!0,lineNumbers:!0,mode:"yaml"}}):"-"})]})]})}):null;return(0,i.jsxs)(s.a,{children:[r,o]})},ef=e=>{let{activeTab:n,onChange:t}=e;return(0,i.jsx)(s.a,{flex:{justifyContent:"space-between",alignItems:"center"},padding:{horizontal:24},border:"bottom",children:(0,i.jsx)(b,{activeTab:n,onChange:t})})},eC=e=>{let{hasSupport:n,concurrencyKeys:t,refetch:r,minValue:o,maxValue:l}=e,[c,a]=g.useState(!1),[d,h]=g.useState(""),m=()=>a(!0),p=g.useMemo(()=>[...t].filter(e=>e.includes(d)).sort((e,n)=>eu.Vp.compare(e,n)),[t,d]);return n?(0,i.jsxs)(s.a,{flex:{direction:"column"},style:{overflow:"auto",height:"100%"},children:[(0,i.jsx)(eb,{onAdd:m,search:d,setSearch:h}),0===t.length?(0,i.jsx)(s.a,{margin:24,children:(0,i.jsx)(u.I,{icon:"error",title:"No pool limits",description:(0,i.jsxs)(i.Fragment,{children:["No pool limits have been configured for this instance.\xa0",(0,i.jsx)(x.v,{onClick:()=>m(),children:"Add a pool limit"}),"."]})})}):p.length?(0,i.jsx)(eo,{concurrencyKeys:p}):(0,i.jsx)(s.a,{padding:16,children:(0,i.jsx)(u.I,{icon:"no-results",title:"No pool limits",description:"No pool limits matching the filter."})}),(0,i.jsx)(ev,{open:!!c,onClose:()=>a(!1),onComplete:r,minValue:null!=o?o:1,maxValue:null!=l?l:1e3})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eb,{}),(0,i.jsx)(s.a,{margin:24,children:(0,i.jsx)(u.I,{icon:"error",title:"No concurrency support",description:"This instance does not currently support pool-based concurrency limits. You may need to run `dagster instance migrate` to add the necessary tables to your dagster storage to support this feature."})})]})},eb=e=>{let{onAdd:n,setSearch:t,search:r}=e;return(0,i.jsx)(s.a,{flex:{direction:"column"},children:t?(0,i.jsxs)(s.a,{flex:{direction:"row",justifyContent:"space-between"},padding:{vertical:16,horizontal:24},border:"bottom",children:[(0,i.jsx)(h.k,{value:r||"",style:{width:"30vw",minWidth:150,maxWidth:400},placeholder:"Filter pools",onChange:e=>t(e.target.value)}),n?(0,i.jsx)(m.$n,{icon:(0,i.jsx)(p.In,{name:"add_circle"}),onClick:()=>n(),children:"Add pool limit"}):null]}):null})},ev=e=>{let{open:n,onClose:t,onComplete:r,maxValue:o,minValue:l}=e,[c,a]=g.useState(!1),[d,u]=g.useState(""),[x,p]=g.useState("");g.useEffect(()=>{u(""),p("")},[n]);let[y]=(0,_.n_)(L.Xg),f=async()=>{a(!0),await y({variables:{concurrencyKey:x,limit:parseInt(d.trim())}}),a(!1),r(),t()};return(0,i.jsxs)(j.lG,{isOpen:n,title:"Add pool limit",onClose:t,children:[(0,i.jsxs)(j.R4,{children:[(0,i.jsx)(s.a,{margin:{bottom:4},children:"Pool:"}),(0,i.jsx)(s.a,{margin:{bottom:16},children:(0,i.jsx)(h.k,{value:x||"",onChange:e=>p(e.target.value),placeholder:"Pool"})}),(0,i.jsxs)(s.a,{margin:{bottom:4},children:["Pool limit (",l,"-",o,"):"]}),(0,i.jsx)(s.a,{children:(0,i.jsx)(h.k,{value:d||"",onChange:e=>u(e.target.value),placeholder:"".concat(l," - ").concat(o)})})]}),(0,i.jsxs)(j.Es,{children:[(0,i.jsx)(m.$n,{intent:"none",onClick:t,children:"Cancel"}),(0,i.jsx)(m.$n,{intent:"primary",onClick:f,disabled:!O(d.trim(),l,o)||!x||c,children:c?"Adding...":"Add limit"})]})]})},eI=(0,_.J1)(ex()),eS=(0,_.J1)(eh(),eI)},75575:(e,n,t)=>{t.d(n,{q:()=>g});var r=t(6029),i=t(34419),s=t(21316),o=t(55729),l=t(87771),c=t(79590),a=t(49575),d=t(27589),u=t(97962),x=t(36660),h=t(33858);let m=(0,o.memo)(()=>{let{daemons:e}=(0,o.useContext)(h.d);return e?(0,r.jsx)(d.m,{content:e.content,position:"bottom",modifiers:{offset:{enabled:!0,options:{offset:[0,28]}}},children:(0,r.jsx)(u.In,{name:"warning",color:x.Ym()})}):null});var p=t(71599);let j=(0,o.memo)(e=>{let{placeholder:n}=e,{codeLocations:t}=(0,o.useContext)(h.d);return t?"spinner"===t.type?(0,r.jsx)(d.m,{content:t.content,placement:"bottom",children:(0,r.jsx)(p.y,{purpose:"body-text",fillColor:x.fR()})}):(0,r.jsx)(d.m,{content:t.content,position:"bottom",modifiers:{offset:{enabled:!0,options:{offset:[0,28]}}},children:(0,r.jsx)(u.In,{name:"warning",color:x.Ym()})}):n?(0,r.jsx)("div",{style:{width:"16px"}}):null});var y=t(48780);let g=e=>{let{refreshState:n,tab:t}=e,{healthTitle:d}=(0,o.useContext)(l.y),u=(0,c.d)();return(0,r.jsxs)(i.a,{flex:{direction:"row",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,r.jsxs)(s.tU,{selectedTabId:t,children:[(0,r.jsx)(y.s,{id:"locations",title:"Code locations",to:"/locations",icon:(0,r.jsx)(j,{placeholder:!1})}),(0,r.jsx)(y.s,{id:"health",title:d,to:"/health",icon:(0,r.jsx)(m,{})}),u?(0,r.jsx)(y.s,{id:"concurrency",title:"Concurrency",to:"/concurrency"}):null,u?(0,r.jsx)(y.s,{id:"config",title:"Configuration",to:"/config"}):null]}),n?(0,r.jsx)(i.a,{padding:{bottom:8},children:(0,r.jsx)(a.D7,{refreshState:n})}):null]})}}}]);
//# sourceMappingURL=794.4853a169eb3af290.js.map